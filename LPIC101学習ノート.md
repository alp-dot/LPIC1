# LPIC 101 学習ノート

## 1. カーネルモジュール管理

### 概要
*   カーネルの機能を部品化（モジュール化）し、必要に応じてロード/アンロードする仕組み。
*   利点: カーネルの軽量化、メモリ効率化、機能追加/更新の容易化。

### 主要コマンドとポイント
*   **`modprobe`**: **依存関係を自動解決**してモジュールをロード/アンロード (`-r`) する最重要コマンド。
    *   設定: `/etc/modprobe.d/` (オプション、エイリアス、ブラックリスト)
*   **`lsmod`**: ロード済みモジュールの一覧表示。
*   **`insmod` / `rmmod`**: 依存関係を**考慮せず**にロード/アンロード。`modprobe` の利用が推奨される。
*   **`modinfo`**: モジュールの詳細情報（パラメータ等）を表示。
*   **`depmod`**: 依存関係ファイル (`modules.dep`) を生成/更新。`modprobe` が参照する。
*   **`/etc/modules-load.d/`**: 起動時に自動ロードするモジュールを指定するディレクトリ。
*   **注意**: `lspci`, `lsusb` はデバイス情報表示コマンドであり、モジュール管理コマンドではない。

### 試験対策の要点
*   `modprobe` の依存関係解決能力が最頻出。
*   各コマンドの基本的な役割を理解する。
*   設定ファイル/ディレクトリの用途 (`/etc/modprobe.d/`, `/etc/modules-load.d/`) を把握する。
*   `insmod`/`rmmod` と `modprobe` の違いを明確にする。

## 2. ランレベル

### 概要
*   **概要**: Linuxシステムの動作モード/状態を示す番号 (0-6)。各レベルで起動サービス等が定義される。
*   **主要なレベル**:
    *   0: シャットダウン
    *   1: シングルユーザーモード (メンテナンス用)
    *   3: マルチユーザーモード (テキスト、ネットワークあり)
    *   5: マルチユーザーモード (グラフィカル、ネットワークあり)
    *   6: 再起動
*   **補足**: 近年は `systemd` の `target` が主流だが、互換性のためランレベルの概念も重要。

### ランレベルの確認
*   **概要**: 現在および直前のランレベルを確認する方法。
*   **主要コマンドとポイント**:
    *   `runlevel`: 現在および直前のランレベルを表示する。出力の1文字目は直前のランレベル（未変更ならN）、2文字目は現在のランレベルを示す。
    *   `init`/`telinit`: ランレベルを変更するコマンド。
    *   `acpid`: ACPIイベントを処理するデーモンであり、ランレベル確認とは直接関係ない。
*   **試験対策の要点**:
    *   `runlevel` コマンドの基本的な使い方と出力形式（例: `N 5` の意味）を理解する。
    *   ランレベルの「変更」コマンド (`init`, `telinit`) と「確認」コマンド (`runlevel`) を区別する。

## 3. systemd

### 概要
*   **概要**: 従来の `init` (SysVinit) を置き換える、Linuxの新しい初期化システム。
*   **主要概念とポイント**:
    *   **`Unit`**: systemdが管理する処理の基本単位。設定ファイルに基づき systemd 自身が処理を実行する (スクリプト実行ではない)。
    *   **並列起動**: サービスを依存関係に基づいて並列に起動するため、システムの起動・停止が高速。
    *   **`cgroups`**: Linuxカーネルの機能を利用し、プロセスグループ単位でリソース (CPU、メモリ等) を管理する。
    *   **比較**:
        *   `SysVinit`: 起動スクリプト (`/etc/init.d/`) を逐次実行する。
        *   `Upstart`: ジョブ (`job`) 単位で管理、イベント駆動、並列起動。(`systemd` の前身の一つ)
*   **試験対策の要点**:
    *   `Unit` という管理単位と、設定ファイルで動作を定義する点を理解する。
    *   サービスの「並列起動」による高速化が大きな特徴であることを覚える。
    *   `cgroups` を利用したリソース管理機能を持つことを知る。
    *   `SysVinit` (スクリプト、逐次) や `Upstart` (ジョブ) との基本的な違いを区別する。

## 4. カーネルメッセージログ (`/var/log/dmesg` と `dmesg`)

### 概要
*   **概要**: システム起動時のカーネルメッセージ（リングバッファの内容）とその確認方法。
*   **主要コマンド/概念とポイント**:
    *   **`/var/log/dmesg`** (ファイル): システム**起動時**のカーネルメッセージを保存したログファイル。**再起動時に内容が更新**される。起動障害の調査に役立つ。（※システムによっては存在しない場合もある）
    *   **`dmesg`** (コマンド): **現在**のカーネルリングバッファの内容を表示する。リングバッファはメモリ上の固定サイズ領域で、古いメッセージは上書きされる。
    *   **カーネルリングバッファ**: カーネルメッセージを一時的に保持するメモリ領域。再起動でクリアされ、運用中に古いものから上書きされる。
    *   `dmesg --clear`: リングバッファの内容をクリアするコマンド。`/var/log/dmesg` ファイルには影響しない。
*   **試験対策の要点**:
    *   `/var/log/dmesg` は「起動時のログ」であり、**再起動時に更新**される点を明確に理解する。
    *   `dmesg` コマンドは「現在のリングバッファ」を表示するものであり、時間経過で内容が変わる可能性があることを把握する。
    *   `/var/log/dmesg` ファイルと `dmesg` コマンドが表示するリングバッファは、別々に管理され、更新/クリアのタイミングが異なることを区別する。

## 5. SysVinit 設定の再読み込み (`/etc/inittab`)

### 概要
*   **概要**: SysVinit のメイン設定ファイル `/etc/inittab` の変更を、システムを再起動せずに即座に反映させる方法。
*   **主要コマンドとポイント**:
    *   `init q` / `init Q`: `init` プロセスに `/etc/inittab` を再読み込みさせる。
    *   `telinit q` / `telinit Q`: `init` プロセスに `/etc/inittab` を再読み込みさせる (`telinit` は `init` へのインターフェース)。
    *   `/etc/inittab`: SysVinit の動作 (デフォルトランレベル、起動時プロセスなど) を定義する設定ファイル。
*   **試験対策の要点**:
    *   `/etc/inittab` を編集した後、即座に反映させるには `init` または `telinit` コマンドに `q` または `Q` オプションを付けて実行することを覚える。
    *   他のオプション (`reload`, `reboot`, `R` など) は `/etc/inittab` の再読み込みには使用しないことを理解する。 